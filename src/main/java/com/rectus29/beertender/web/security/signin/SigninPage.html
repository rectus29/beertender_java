<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns:wicket="http://wicket.apache.org">
<wicket:head>
	<script>
		function start() {
			gapi.load('auth2', function() {
				auth2 = gapi.auth2.init({
					client_id: '708114846781-bo0iiu7basehi6ueqlopuhuedr609f8h.apps.googleusercontent.com'
				});
			});
		}

		function signInCallback(authResult) {
			if (authResult['code']) {
				// Send the code to the server
				$.ajax({
					type: 'POST',
					url: 'googleOauthSignin',
					// Always include an `X-Requested-With` header in every AJAX request,
					// to protect against CSRF attacks.
					headers: {
						'X-Requested-With': 'XMLHttpRequest'
					},
					contentType: 'application/octet-stream; charset=utf-8',
					success: function(result) {
						window.location.assign('home');
						// Handle or verify the server response.
					},
					error: function(result){
						alert("Error while Google Authentication");
						$('#signinButton i').toggleClass('fa-spin');
					},
					processData: false,
					data: authResult['code']
				});
			} else {
				// There was an error.
			}
		}
	</script>
	<style>
		html,
		body {
			height: 100%;
		}

		body {
			display: -ms-flexbox;
			display: -webkit-box;
			display: flex;
			-ms-flex-align: center;
			-ms-flex-pack: center;
			-webkit-box-align: center;
			align-items: center;
			-webkit-box-pack: center;
			justify-content: center;
			padding-top: 40px;
			padding-bottom: 40px;
			background-color: #f5f5f5;
		}

		.form-signin {
			width: 100%;
			max-width: 330px;
			padding: 15px;
			margin: 0 auto;
		}

		.form-signin .checkbox {
			font-weight: 400;
		}

		.form-signin .form-control {
			position: relative;
			box-sizing: border-box;
			height: auto;
			padding: 10px;
			font-size: 16px;
		}

		.form-signin .form-control:focus {
			z-index: 2;
		}

		.form-signin input[type="email"] {
			margin-bottom: -1px;
			border-bottom-right-radius: 0;
			border-bottom-left-radius: 0;
		}

		.form-signin input[type="password"] {
			margin-bottom: 10px;
			border-top-left-radius: 0;
			border-top-right-radius: 0;
		}

	</style>
</wicket:head>
<wicket:extend>
	<div class="container login-holder">
		<div class="text-center">
			<form class="form-signin" wicket:id="authenticationForm">
				<img class="mb-4" src="img/beer.png" alt="" width="72" height="72">
				<h1 class="h3 mb-3 font-weight-normal">Connexion</h1>
				<label for="inputEmail" class="sr-only">Email</label>
				<div class="form-group">
					<input type="email" id="inputEmail" class="form-control" wicket:id="username" placeholder="Email" required="" autofocus="">
				</div>
				<label for="inputPassword" class="sr-only">Mot de passe</label>
				<div class="form-group">
					<input type="password" id="inputPassword" wicket:id="password" class="form-control" placeholder="Mot de passe" required="">
				</div>
				<div class="checkbox mb-3">
					<label>
						<input type="checkbox" value="remember-me" wicket:id="rememberMe"> Remember me
					</label>
				</div>
				<div wicket:id="feedback"/>
				<button class="btn btn-lg btn-primary btn-block" type="submit">Sign in</button>
				<hr>
				<div>
					<button class="btn btn-lg" id="signinButton">
						<i class="fa fa-google"></i> Sign in with Google
					</button>
					<script>
						$('#signinButton').click(function () {
							$('#signinButton i').toggleClass('fa-spin');
							// signInCallback defined in step 6.
							auth2.grantOfflineAccess().then(signInCallback);
						});
					</script>
				</div>
				<div class="mt-5 mb-3 text-muted">
					V&nbsp;<span wicket:id="versionNumber"/> &nbsp;|&nbsp;&copy; 2017-2018
				</div>
			</form>
		</div>
	</div>

</wicket:extend>
</html>